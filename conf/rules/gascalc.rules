rule "Gas_calc_minute"
	when 
		Time cron "0 0/1 * * * ? *"
	then
		Gas_Cons.postUpdate(WB_GasCounter.deltaSince(now().minusMinutes(1)) * 60)
end

rule "Gas calc month"
	when 
		Time cron "0 5 0 * * ? *"
	then    
	val  ZonedDateTime 	zdtg = ZonedDateTime.now();
    val Number gcons_month = WB_GasCounter.deltaSince(zdtg.withDayOfMonth(1).toLocalDate().atStartOfDay(zdtg.getZone()));
    if (gcons_month !== null) Gas_ConsM.postUpdate(gcons_month);

end

rule "Gas calc today"
	when 
		Time cron "0 0/5 * * * ? *"
	then    
	val  ZonedDateTime 	zdt = ZonedDateTime.now()
    var  ZonedDateTime 	start_of_day = zdt.toLocalDate().atStartOfDay(zdt.getZone())
    var gcons_today = WB_GasCounter.deltaSince(start_of_day)
	Gas_ConsToday.postUpdate(gcons_today);

end