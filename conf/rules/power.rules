rule "Power calc"
	when 
		Time cron "0 0/5 * * * ? *"
	then

	val  ZonedDateTime 	zdt = ZonedDateTime.now();
    val Number pconsmn = Power_Energy.deltaSince(zdt.toLocalDate().atStartOfDay(zdt.getZone()));
    Power_ConsMN.postUpdate(pconsmn);
    val Number pcons = Power_Energy.deltaSince(zdt.minusDays(1).toLocalDate().atStartOfDay(zdt.getZone()));
    val Number pcons_calc = pcons - pconsmn;
    if (pcons_calc >= 0) Power_Cons.postUpdate(pcons_calc);
    val Number pconsm = Power_Energy.deltaSince(zdt.withDayOfMonth(1).toLocalDate().atStartOfDay(zdt.getZone()));
    Power_ConsM.postUpdate(pconsm);
   	EnergyMonthValue.postUpdate((Power_ConsM.state as Number) * (EnergyValue.state as Number));

end